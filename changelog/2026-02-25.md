# 2026-02-25 — Repo Cleanup & Hygiene

## Migration Fix (Critical)
- Fixed duplicate migration ID `'011'` in `src/lib/db/migrations.ts` → renamed to `'015b'`
- Added duplicate ID detection in `runMigrations()` — throws on startup if duplicates found
- **Result:** Test suite went from 31/101 to 101/101 passing

## Build Artifact Cleanup
- Removed committed `coverage/`, `playwright-report/`, `test-results/`, `tsconfig.tsbuildinfo`
- Removed unreferenced `docs/images/mission_control.png` (489K)

## Console Logging Audit
- Removed debug `console.log` in `PlanningTab.tsx` (dispatch retry)
- Kept all `console.error`/`console.warn` in catch blocks (appropriate for PM2 logging)
- SSEDebugPanel console interception is intentional (gated by MC_DEBUG flag)

## Documentation Consolidation
- Moved 7 root .md files to `docs/` directory
- Updated cross-references in README.md, heartbeat, quickstart, production-setup docs
- Root now has 4 .md files: README, CHANGELOG, AGENTS, CLAUDE

## AgentDetailPanel Decomposition
- Split 700-line component into 4 focused sub-components:
  - `AgentOverviewSection.tsx` (125 LOC)
  - `AgentCapabilitiesSection.tsx` (228 LOC)
  - `AgentCronsSection.tsx` (109 LOC)
  - `AgentMarkdownTab.tsx` (25 LOC)
- Orchestrator reduced to 338 LOC

## API Route DRY-up
- Created `src/lib/api-helpers.ts` with `buildPatchQuery()` and `notFound()`
- Refactored 5 PATCH handlers (agents, capabilities, crons, integrations, workspaces)

## CLAUDE.md & AGENTS.md Upgrades
- Added code hygiene rules, post-task reflection protocol
- Fixed incorrect "7 known middleware auth failures" → 101/101 passing
- Fixed incorrect "IPv6 bug" gotcha → documented real migration ID issue
- Added autonomy boundaries, expanded anti-patterns
- Created `changelog/` system
